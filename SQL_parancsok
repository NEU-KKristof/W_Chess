CREATE DATABASE IF NOT EXISTS `sakk_adatbazis`
CHARACTER SET utf8mb4
COLLATE utf8mb4_hungarian_ci;
USE `sakk_adatbazis`;
CREATE TABLE IF NOT EXISTS `users` (
    `id` INT AUTO_INCREMENT PRIMARY KEY,
    `username` VARCHAR(50) NOT NULL UNIQUE,
    `email` VARCHAR(100) NOT NULL UNIQUE,
    `password_hash` VARCHAR(255) NOT NULL, -- Itt tároljuk a VÉDETT, hashelt jelszót
    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_hungarian_ci;

CREATE TABLE IF NOT EXISTS `matches` (
    `id` INT AUTO_INCREMENT PRIMARY KEY,
    `user_id_white` INT NOT NULL,
    `user_id_black` INT NOT NULL,
    `match_data` TEXT, -- Ide mentheted a lépéseket (pl. JSON vagy PGN formátumban)
    `winner_id` INT, -- A győztes user ID-ja, (0 döntetlen esetén, NULL ha még tart)
    `played_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (`user_id_white`) REFERENCES `users`(`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id_black`) REFERENCES `users`(`id`) ON DELETE CASCADE,
    FOREIGN KEY (`winner_id`) REFERENCES `users`(`id`) ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_hungarian_ci;
